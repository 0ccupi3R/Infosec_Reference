http://msdn.microsoft.com/en-us/library/aa394102%28v=vs.85%29.aspx

http://msdn.microsoft.com/en-us/library/aa394077%28v=vs.85%29.aspx




https://github.com/a0rtega/pafish
Paranoid Fish) 
Pafish is a demo tool that performs some anti(debugger/VM/sandbox) tricks. Most of them are often used by malware to avoid debugging and dynamic analysis. 
The project is open source, you can read the code of all anti-analysis checks. You can also download the compiled executable (or compile it by yourself) and reverse engineer it, which is quite recommended.
Goal of the project is *not* to implemement complex VM detections.