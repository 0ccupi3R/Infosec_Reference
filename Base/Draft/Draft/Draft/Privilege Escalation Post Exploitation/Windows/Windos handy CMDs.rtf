{\rtf1\ansi\ansicpg1252\uc1\deff0
{\fonttbl{\f0\fmodern\fcharset0\fprq2 Courier New;}}
{\colortbl;\red0\green0\blue0;\red255\green255\blue255;}
\paperw12240\paperh15840\margl1800\margr1800\margt1440\margb1440\fet2\ftnbj\aenddoc
\pgnrestart\pgnstarts0
\pard\plain \fi720\ltrch\loch {\f0\fs24\b0\i0 WINDOWS CMD REF}
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 http://www.rebootuser.com/?p=1623}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Kernel, Operating System & Device Information:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 uname -a \tab Print all available system information}
\par\plain {\f0\fs24\b0\i0 uname -r \tab Kernel release}
\par\plain {\f0\fs24\b0\i0 uname -n \tab System hostname}
\par\plain {\f0\fs24\b0\i0 hostname \tab As above}
\par\plain {\f0\fs24\b0\i0 uname -m \tab Linux kernel architecture (32 or 64 bit)}
\par\plain {\f0\fs24\b0\i0 cat /proc/version \tab Kernel information}
\par\plain {\f0\fs24\b0\i0 cat /etc/*-release \tab Distribution information}
\par\plain {\f0\fs24\b0\i0 cat /etc/issue \tab As above}
\par\plain {\f0\fs24\b0\i0 cat /proc/cpuinfo \tab CPU information}
\par\plain {\f0\fs24\b0\i0 df -a \tab File system information}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Users & Groups:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 cat /etc/passwd \tab List all users on the system}
\par\plain {\f0\fs24\b0\i0 cat /etc/group \tab List all groups on the system}
\par\plain {\f0\fs24\b0\i0 for i in $(cat /etc/passwd 2>/dev/null| cut -d":" -f1 2>/dev/null);do id $i;done 2>/dev/null \tab List all uid\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92s and respective group memberships}
\par\plain {\f0\fs24\b0\i0 cat /etc/shadow \tab Show user hashes \endash  Privileged command}
\par\plain {\f0\fs24\b0\i0 grep -v -E "^#" /etc/passwd | awk -F: '$3 == 0 \{ print $1\}' \tab List all super user accounts}
\par\plain {\f0\fs24\b0\i0 finger \tab Users currently logged in}
\par\plain {\f0\fs24\b0\i0 pinky \tab As above}
\par\plain {\f0\fs24\b0\i0 users \tab As above}
\par\plain {\f0\fs24\b0\i0 who -a \tab As above}
\par\plain {\f0\fs24\b0\i0 w \tab Who is currently logged in and what they\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92re doing}
\par\plain {\f0\fs24\b0\i0 last \tab Listing of last logged on users}
\par\plain {\f0\fs24\b0\i0 lastlog \tab Information on when all users last logged in}
\par\plain {\f0\fs24\b0\i0 lastlog \endash u %username% \tab Information on when the specified user last logged in}
\par\plain {\f0\fs24\b0\i0 lastlog |grep -v "Never" \tab Entire list of previously logged on users}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 User & Privilege Information:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 whoami \tab Current username}
\par\plain {\f0\fs24\b0\i0 id \tab Current user information}
\par\plain {\f0\fs24\b0\i0 cat /etc/sudoers \tab Who\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92s allowed to do what as root \endash  Privileged command}
\par\plain {\f0\fs24\b0\i0 sudo -l \tab Can the current user perform anything as root}
\par\plain {\f0\fs24\b0\i0 sudo -l 2>/dev/null | grep -w 'nmap\\|perl\\|'awk'\\|'find'\\|'bash'\\|'sh'\\|'man'\\}
\par\plain {\f0\fs24\b0\i0 |'more'\\|'less'\\|'vi'\\|'vim'\\|'nc'\\|'netcat'\\|python\\}
\par\plain {\f0\fs24\b0\i0 |ruby\\|lua\\|irb' | xargs -r ls -la 2>/dev/null \tab Can the current user run any \loch\af0\hich\af0\dbch\af0\uc1\u8216\'91interesting\u8217\'92 binaries as root and if so also display the binary permissions etc.}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Environmental Information:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 env \tab Display environmental variables}
\par\plain {\f0\fs24\b0\i0 set \tab As above}
\par\plain {\f0\fs24\b0\i0 echo $PATH \tab Path information}
\par\plain {\f0\fs24\b0\i0 history \tab Displays command history of current user}
\par\plain {\f0\fs24\b0\i0 pwd \tab Print working directory, i.e. \loch\af0\hich\af0\dbch\af0\uc1\u8216\'91where am I\u8217\'92}
\par\plain {\f0\fs24\b0\i0 cat /etc/profile \tab Display default system variables}
\par\plain {\f0\fs24\b0\i0 cat /etc/shells \tab Display available shells}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Interesting Files:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 find / -perm -4000 -type f 2>/dev/null \tab Find SUID files}
\par\plain {\f0\fs24\b0\i0 find / -uid 0 -perm -4000 -type f 2>/dev/null \tab Find SUID files owned by root}
\par\plain {\f0\fs24\b0\i0 find / -perm -2000 -type f 2>/dev/null \tab Find GUID files}
\par\plain {\f0\fs24\b0\i0 find / -perm -2 -type f 2>/dev/null \tab Find world-writeable files}
\par\plain {\f0\fs24\b0\i0 find / ! -path "*/proc/*" -perm -2 -type f -print 2>/dev/null \tab Find world-writeable files excluding those in /proc}
\par\plain {\f0\fs24\b0\i0 find / -perm -2 -type d 2>/dev/null \tab Find word-writeable directories}
\par\plain {\f0\fs24\b0\i0 find /home \endash name *.rhosts -print 2>/dev/null \tab Find rhost config files}
\par\plain {\f0\fs24\b0\i0 find /home -iname *.plan -exec ls -la \{\} \\; -exec cat \{\} 2>/dev/null \\; \tab Find *.plan files, list permissions and cat the file contents}
\par\plain {\f0\fs24\b0\i0 find /etc -iname hosts.equiv -exec ls -la \{\} 2>/dev/null \\; -exec cat \{\} 2>/dev/null \\; \tab Find hosts.equiv, list permissions and cat the file contents}
\par\plain {\f0\fs24\b0\i0 ls -ahlR /root/ \tab See if you can access other user directories to find interesting files}
\par\plain {\f0\fs24\b0\i0 cat ~/.bash_history \tab Show the current users\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92 command history}
\par\plain {\f0\fs24\b0\i0 ls -la ~/.*_history \tab Show the current users\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92 various history files}
\par\plain {\f0\fs24\b0\i0 ls -la /root/.*_history \tab Can we read root\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92s history files}
\par\plain {\f0\fs24\b0\i0 ls -la ~/.ssh/ \tab Check for interesting ssh files in the current users\loch\af0\hich\af0\dbch\af0\uc1\u8217\'92 directory}
\par\plain {\f0\fs24\b0\i0 find / -name "id_dsa*" -o -name "id_rsa*" -o -name "known_hosts" -o -name "authorized_hosts" -o -name "authorized_keys" 2>/dev/null |xargs -r ls -la \tab Find SSH keys/host information}
\par\plain {\f0\fs24\b0\i0 ls -la /usr/sbin/in.* \tab Check Configuration of inetd services}
\par\plain {\f0\fs24\b0\i0 grep -l -i pass /var/log/*.log 2>/dev/null \tab Check log files for keywords (\loch\af0\hich\af0\dbch\af0\uc1\u8216\'91pass\u8217\'92 in this example) and show positive matches}
\par\plain {\f0\fs24\b0\i0 find /var/log -type f -exec ls -la \{\} \\; 2>/dev/null \tab List files in specified directory (/var/log)}
\par\plain {\f0\fs24\b0\i0 find /var/log -name *.log -type f -exec ls -la \{\} \\; 2>/dev/null \tab List .log files in specified directory (/var/log)}
\par\plain {\f0\fs24\b0\i0 find /etc/ -maxdepth 1 -name *.conf -type f -exec ls -la \{\} \\; 2>/dev/null \tab List .conf files in /etc (recursive 1 level)}
\par\plain {\f0\fs24\b0\i0 ls -la /etc/*.conf \tab As above}
\par\plain {\f0\fs24\b0\i0 find / -maxdepth 4 -name *.conf -type f -exec grep -Hn password \{\} \\; 2>/dev/null \tab Find .conf files (recursive 4 levels) and output line number where the word \loch\af0\hich\af0\dbch\af0\uc1\u8216\'91password\u8217\'92 is located}
\par\plain {\f0\fs24\b0\i0 lsof -i -n \tab List open files (output will depend on account privileges)}
\par\plain {\f0\fs24\b0\i0 head /var/mail/root \tab Can we read roots mail}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Service Information:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 ps aux | grep root \tab View services running as root}
\par\plain {\f0\fs24\b0\i0 ps aux | awk '\{print $11\}'|xargs -r ls -la 2>/dev/null |awk '!x[$0]++' \tab Lookup process binary path and permissions}
\par\plain {\f0\fs24\b0\i0 cat /etc/inetd.conf \tab List services managed by inetd}
\par\plain {\f0\fs24\b0\i0 cat /etc/xinetd.conf \tab As above for xinetd}
\par\plain {\f0\fs24\b0\i0 cat /etc/xinetd.conf 2>/dev/null | awk '\{print $7\}' |xargs -r ls -la 2>/dev/null \tab A very \loch\af0\hich\af0\dbch\af0\uc1\u8216\'91rough\u8217\'92 command to extract associated binaries from xinetd.conf and show permissions of each}
\par\plain {\f0\fs24\b0\i0 ls -la /etc/exports 2>/dev/null; cat /etc/exports 2>/dev/null \tab Permissions and contents of /etc/exports (NFS)}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Jobs/Tasks:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 crontab -l -u %username% \tab Display scheduled jobs for the specified user \endash  Privileged command}
\par\plain {\f0\fs24\b0\i0 ls -la /etc/cron* \tab Scheduled jobs overview (hourly, daily, monthly etc)}
\par\plain {\f0\fs24\b0\i0 ls -aRl /etc/cron* | awk '$1 ~ /w.$/' 2>/dev/null \tab What can \loch\af0\hich\af0\dbch\af0\uc1\u8216\'91others\u8217\'92 write in /etc/cron* directories}
\par\plain {\f0\fs24\b0\i0 top \tab List of current tasks}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Networking, Routing & Communications:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 /sbin/ifconfig -a \tab List all network interfaces}
\par\plain {\f0\fs24\b0\i0 cat /etc/network/interfaces \tab As above}
\par\plain {\f0\fs24\b0\i0 arp -a \tab Display ARP communications}
\par\plain {\f0\fs24\b0\i0 route \tab Display route information}
\par\plain {\f0\fs24\b0\i0 cat /etc/resolv.conf \tab Show configured DNS sever addresses}
\par\plain {\f0\fs24\b0\i0 netstat -antp \tab List all TCP sockets and related PIDs (-p Privileged command)}
\par\plain {\f0\fs24\b0\i0 netstat -anup \tab List all UDP sockets and related PIDs (-p Privileged command)}
\par\plain {\f0\fs24\b0\i0 iptables -L \tab List rules \endash  Privileged command}
\par\plain {\f0\fs24\b0\i0 cat /etc/services \tab View port numbers/services mappings}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Programs Installed:}
\par\plain {\f0\fs24\b0\i0 Command \tab Result}
\par\plain {\f0\fs24\b0\i0 dpkg -l \tab Installed packages (Debian)}
\par\plain {\f0\fs24\b0\i0 rpm -qa \tab Installed packages (Red Hat)}
\par\plain {\f0\fs24\b0\i0 sudo -V \tab Sudo version \endash  does an exploit exist?}
\par\plain {\f0\fs24\b0\i0 httpd -v \tab Apache version}
\par\plain {\f0\fs24\b0\i0 apache2 -v \tab As above}
\par\plain {\f0\fs24\b0\i0 apache2ctl (or apachectl) -M \tab List loaded Apache modules}
\par\plain {\f0\fs24\b0\i0 mysql --version \tab Installed MYSQL version details}
\par\plain {\f0\fs24\b0\i0 psql -V \tab Installed Postgres version details}
\par\plain {\f0\fs24\b0\i0 perl -v \tab Installed Perl version details}
\par\plain {\f0\fs24\b0\i0 java -version \tab Installed Java version details}
\par\plain {\f0\fs24\b0\i0 python --version \tab Installed Python version details}
\par\plain {\f0\fs24\b0\i0 ruby -v \tab Installed Ruby version details}
\par\plain {\f0\fs24\b0\i0 find / -name %program_name% 2>/dev/null (i.e. nc, netcat, wget, nmap etc) \tab Locate \loch\af0\hich\af0\dbch\af0\uc1\u8216\'91useful\u8217\'92 programs (netcat, wget etc)}
\par\plain {\f0\fs24\b0\i0 which %program_name% (i.e. nc, netcat, wget, nmap etc) \tab As above}
\par\plain {\f0\fs24\b0\i0 dpkg --list 2>/dev/null| grep compiler |grep -v decompiler 2>/dev/null && yum list installed 'gcc*' 2>/dev/null| grep gcc 2>/dev/null \tab List available compilers}
\par\plain {\f0\fs24\b0\i0 cat /etc/apache2/envvars 2>/dev/null |grep -i 'user\\|group' |awk '\{sub(/.*\\export /,"")\}1'}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 \tab Which account is Apache running as}
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0  }
\par\plain \f0\fs24\b0\i0
\par\plain {\f0\fs24\b0\i0 Common Shell Escape Sequences:}
\par\plain {\f0\fs24\b0\i0 Command \tab Program(s)}
\par\plain {\f0\fs24\b0\i0 :!bash \tab vi, vim}
\par\plain {\f0\fs24\b0\i0 :set shell=/bin/bash:shell \tab vi, vim}
\par\plain {\f0\fs24\b0\i0 !bash \tab man, more, less}
\par\plain {\f0\fs24\b0\i0 find / -exec /usr/bin/awk 'BEGIN \{system("/bin/bash")\}' \\; \tab find}
\par\plain {\f0\fs24\b0\i0 awk 'BEGIN \{system("/bin/bash")\}' \tab awk}
\par\plain {\f0\fs24\b0\i0 --interactive \tab nmap}
\par\plain {\f0\fs24\b0\i0 perl -e 'exec "/bin/bash";' \tab Perl}}