Privilege Escalation Techniques in Windows

[All roads lead to SYSTEM](https://labs.mwrinfosecurity.com/system/assets/760/original/Windows_Services_-_All_roads_lead_to_SYSTEM.pdf)



[PyKEK](https://github.com/bidord/pykek)
* PyKEK (Python Kerberos Exploitation Kit), a python library to manipulate KRB5-related data. (Still in development)




Tools


PowerUp
Description: PowerUp is a powershell tool to assist with local privilege escalation on Windows systems. It contains several methods to identify and abuse vulnerable services, as well as DLL hijacking opportunities, vulnerable registry settings, and escalation opportunities.
Link: https://github.com/HarmJ0y/PowerUp






Fundamental guides to basic privilege escalation
http://www.fuzzysecurity.com/tutorials/16.html
https://forums.hak5.org/index.php?/topic/26709-windows-7-now-secure/
http://obscuresecurity.blogspot.com/2011/11/old-privilege-escalation-techniques.html
https://www.securusglobal.com/community/2013/12/20/dumping-windows-credentials/

Group Policy Preferences trick
http://www.leonteale.co.uk/decrypting-windows-2008-gpp-user-passwords-using-gpprefdecrypt-py/
http://carnal0wnage.attackresearch.com/2012/10/group-policy-preferences-and-getting.html
http://blog.securestate.com/how-to-pwn-systems-through-group-policy-preferences/


http://it-ovid.blogspot.fr/2012/02/windows-privilege-escalation.html
	Cheat sheet- techniques/links

	Windows Exploit Suggester
	From: https://github.com/GDSSecurity/Windows-Exploit-Suggester
	Blog post on it: https://blog.gdssecurity.com/labs/2014/7/11/introducing-windows-exploit-suggester.html	
	Description: 
This tool compares a targets patch levels against the Microsoft vulnerability database in order to detect potential missing patches on the target. It also notifies the user if there are public exploits and Metasploit modules available for the missing bulletins. 
It requires the 'systeminfo' command output from a Windows host in order to compare that the Microsoft security bulletin database and determine the patch level of the host. 
It has the ability to automatically download the security bulletin database from Microsoft with the --update flag, and saves it as an Excel spreadsheet. 
When looking at the command output, it is important to note that it assumes all vulnerabilities and then selectively removes them based upon the hotfix data. This can result in many false-positives, and it is key to know what software is actually running on the target host. For example, if there are known IIS exploits it will flag them even if IIS is not running on the target host.
	



Extra:
Extreme Privelege Escalataion on Windows8 UEFI Systems
https://www.youtube.com/watch?v=UJp_rMwdyyI
https://www.blackhat.com/docs/us-14/materials/us-14-Kallenberg-Extreme-Privilege-Escalation-On-Windows8-UEFI-Systems.pdf
Summary by stormehh from reddit: 
“In this whitepaper (and accompanying Defcon/Blackhat presentations), the authors demonstrate vulnerabilities in the UEFI "Runtime Service" interface accessible by a privileged userland process on Windows 8. This paper steps through the exploitation process in great detail and demonstrates the ability to obtain code execution in SMM and maintain persistence by means of overwriting SPI flash”




